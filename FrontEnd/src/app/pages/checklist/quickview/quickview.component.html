
    <div
        class="card-header bg-primary text-white d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2">

        <!-- Title -->
        <h5 class="mb-2 mb-md-0">CheckList</h5>

        <!-- Date Filters -->
        <div class="d-flex flex-column flex-md-row gap-3">

  <!-- Start Date -->
  <div class="form-floating flex-fill">
    <input 
      type="date" 
      class="form-control" 
      id="startDate"
      placeholder="Start Date"
      [(ngModel)]="startDate"
      (change)="onDateRangeChange()"
  [max]="endDate" />
    <label for="startDate">Start Date</label>
  </div>

  <!-- End Date -->
  <div class="form-floating flex-fill">
    <input 
      type="date" 
      class="form-control" 
      id="endDate"
      placeholder="End Date"
      [(ngModel)]="endDate"
      (change)="onDateRangeChange()"
      [min]="startDate"
 />
    <label for="endDate">End Date</label>
  </div>
<button class="btn btn-light btn-sm" (click)="downloadSelectedData()">
            <i class="bi bi-download"></i> Export to Excel
        </button>
</div>

    </div>

        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="table-dark">
                    <tr>
                                            <th><input type="checkbox" [(ngModel)]="selectAll" (change)="toggleSelectAll()" /></th>

                        <th (click)="sortData('CHECKLIST_ID')" class="sortable">Checklist Id <span *ngIf="sortColumn === 'CHECKLIST_ID'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('EMP_CODE')" class="sortable">Incharge Id <span *ngIf="sortColumn === 'EMP_CODE'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('DIV')" class="sortable">Division <span *ngIf="sortColumn === 'DIV'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('LOC')" class="sortable">Location <span *ngIf="sortColumn === 'LOC'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('ok')" class="sortable">OK Checkpoints <span *ngIf="sortColumn === 'ok'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('notok')" class="sortable">NOT OK Checkpoints <span *ngIf="sortColumn === 'notok'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('na')" class="sortable">NOT Applicable Checkpoints <span *ngIf="sortColumn === 'na'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th (click)="sortData('CREATED_ON')" class="sortable">Created On <span *ngIf="sortColumn === 'CREATED_ON'">{{ sortAscending ? '▲' : '▼' }}</span></th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let user of filteredData,let i = index">
                        <td><input type="checkbox" [checked]="selectedRows.has(i + (currentPage - 1) * itemsPerPage)"
                        (change)="toggleRowSelection(i + (currentPage - 1) * itemsPerPage)" /></td>
                        <td>{{ user.CHECKLIST_ID }}</td>
                        <td>{{ user.EMP_CODE }}</td>
                        <td>{{ user.DIV }}</td>
                        <td>{{ user.LOC }}</td>
                        <td>{{ user.OK }}</td>
                        <td>{{ user.NOTOK }}</td>
                        <td>{{ user.NA }}</td>
                        <td>{{ formatDate(user.CREATED_ON) }}</td>
                        <td>
                            <button class="btn btn-sm btn-primary me-2" (click)="openEditModal(user)">
                                <i class="bi bi-eye"></i> View
                            </button>
                            <button class="btn btn-sm btn-danger" (click)="deleteUser(user.CHECKLIST_ID)">
                                <i class="bi bi-trash"></i> Delete
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card-footer d-flex justify-content-between align-items-center">
            <span>Showing {{ (currentPage - 1) * itemsPerPage + 1 }} - {{ min(currentPage * itemsPerPage, data.length) }} of {{ data.length }} entries</span>
            <ul class="pagination mb-0">
                <li class="page-item" [class.disabled]="currentPage === 1">
                    <a class="page-link" (click)="changePage(currentPage - 1)">Previous</a>
                </li>
                <li class="page-item" [class.disabled]="currentPage === totalPages()">
                    <a class="page-link" (click)="changePage(currentPage + 1)">Next</a>
                </li>
            </ul>
        </div>